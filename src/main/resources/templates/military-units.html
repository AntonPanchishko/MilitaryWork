<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header('Military Units')"></head>
<body class="container mt-4">
<h2 class="mb-4">Military Units</h2>

<!-- Додаємо форму для відправки обраних юнітів -->
<form th:action="@{/ui/save-work-days}" method="post">

    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Обрати</th>
            <th>ID</th>
            <th>Ім'я</th>
            <th>Призвіще</th>
            <th>Всього робочих днів</th>
            <th>Цього тижня</th>
            <th>Відсоток зайобу</th>
            <th>Понеділок</th>
            <th>Вівторок</th>
            <th>Середа</th>
            <th>Четверг</th>
            <th>П'ятниця</th>
            <th>Суббота</th>
            <th>Статус</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="unit : ${units}"
            th:classappend="${unit.unitStatus.name() == 'REMOVED'} ? 'table-secondary' :
                        (${unit.unitStatus.name() == 'ON_SICK_LEAVE'} ? 'table-warning' : '')">
            <td>
                <input type="checkbox" name="unitIds" th:value="${unit.id}">
            </td>
            <td th:text="${unit.id}"></td>
            <td th:text="${unit.name}"></td>
            <td th:text="${unit.lastName}"></td>
            <td th:text="${unit.totalWorkDays}"></td>
            <td th:text="${unit.weekWorkDay}"></td>

            <!-- Колонка з відсотком і динамічним кольором -->
            <td th:text="${unit.involvingProcent}"
                th:with="
            p=${unit.involvingProcent},
            r=${255},
            g=${p < 50 ? 255 : (255 - (p - 50) * 5.1)},
            b=${p < 50 ? (255 - p * 5.1) : 0}"
                th:style="'background-color: rgb(' + ${r} + ',' + ${g} + ',' + ${b} + ');'">
            </td>

            <td th:text="${unit.hasWorkDay(T(java.time.DayOfWeek).MONDAY) ? 1 : 0}"></td>
            <td th:text="${unit.hasWorkDay(T(java.time.DayOfWeek).TUESDAY) ? 1 : 0}"></td>
            <td th:text="${unit.hasWorkDay(T(java.time.DayOfWeek).WEDNESDAY) ? 1 : 0}"></td>
            <td th:text="${unit.hasWorkDay(T(java.time.DayOfWeek).THURSDAY) ? 1 : 0}"></td>
            <td th:text="${unit.hasWorkDay(T(java.time.DayOfWeek).FRIDAY) ? 1 : 0}"></td>
            <td th:text="${unit.hasWorkDay(T(java.time.DayOfWeek).SATURDAY) ? 1 : 0}"></td>

            <td th:text="${unit.unitStatus}"></td>
        </tr>
        </tbody>
    </table>

    <button type="submit" class="btn btn-success mt-3">Попиздили на єбашку</button>

</form>

<a href="/" class="btn btn-secondary mt-3">На головну</a>

<div th:replace="fragments/footer :: footer"></div>
</body>
</html>
